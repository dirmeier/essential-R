<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>4 Working with data | Essential R</title>
  <meta name="description" content="4 Working with data | Essential R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="4 Working with data | Essential R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="dirmeier/essential-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Working with data | Essential R" />
  
  
  

<meta name="author" content="Simon Dirmeier">


<meta name="date" content="2019-03-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r-extensions.html">
<link rel="next" href="data-analysis-and-statistical-modeling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<script src="libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/vega-1.4.3/vega.min.js"></script>
<script src="libs/lodash-2.2.1/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis-0.4.4/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis-0.4.4/js/ggvis.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="theme.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">essential-R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="about.html"><a href="about.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="r-package-development.html"><a href="r-package-development.html"><i class="fa fa-check"></i><b>1</b> R package development</a><ul>
<li class="chapter" data-level="1.1" data-path="r-package-development.html"><a href="r-package-development.html#creating-r-packages"><i class="fa fa-check"></i><b>1.1</b> Creating R packages</a></li>
<li class="chapter" data-level="1.2" data-path="r-package-development.html"><a href="r-package-development.html#writing-r-packages"><i class="fa fa-check"></i><b>1.2</b> Writing R packages</a></li>
<li class="chapter" data-level="1.3" data-path="r-package-development.html"><a href="r-package-development.html#debugging"><i class="fa fa-check"></i><b>1.3</b> Debugging</a></li>
<li class="chapter" data-level="1.4" data-path="r-package-development.html"><a href="r-package-development.html#testing-code"><i class="fa fa-check"></i><b>1.4</b> Testing code</a></li>
<li class="chapter" data-level="1.5" data-path="r-package-development.html"><a href="r-package-development.html#documenting-code"><i class="fa fa-check"></i><b>1.5</b> Documenting code</a></li>
<li class="chapter" data-level="1.6" data-path="r-package-development.html"><a href="r-package-development.html#checking-code"><i class="fa fa-check"></i><b>1.6</b> Checking code</a></li>
<li class="chapter" data-level="1.7" data-path="r-package-development.html"><a href="r-package-development.html#static-code-analysis"><i class="fa fa-check"></i><b>1.7</b> Static code analysis</a><ul>
<li class="chapter" data-level="1.7.1" data-path="r-package-development.html"><a href="r-package-development.html#running-examples"><i class="fa fa-check"></i><b>1.7.1</b> Running examples</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="r-package-development.html"><a href="r-package-development.html#code-coverage"><i class="fa fa-check"></i><b>1.8</b> Code coverage</a></li>
<li class="chapter" data-level="1.9" data-path="r-package-development.html"><a href="r-package-development.html#profiling-and-benchmarking"><i class="fa fa-check"></i><b>1.9</b> Profiling and benchmarking</a></li>
<li class="chapter" data-level="1.10" data-path="r-package-development.html"><a href="r-package-development.html#creating-a-landing-page"><i class="fa fa-check"></i><b>1.10</b> Creating a landing page</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html"><i class="fa fa-check"></i><b>2</b> Programming paradigma in R</a><ul>
<li class="chapter" data-level="2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#functional-programming"><i class="fa fa-check"></i><b>2.1</b> Functional programming</a></li>
<li class="chapter" data-level="2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#object-oriented-programming"><i class="fa fa-check"></i><b>2.2</b> Object-oriented programming</a><ul>
<li class="chapter" data-level="2.2.1" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s3"><i class="fa fa-check"></i><b>2.2.1</b> S3</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#s4"><i class="fa fa-check"></i><b>2.2.2</b> S4</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-paradigma-in-r.html"><a href="programming-paradigma-in-r.html#r6"><i class="fa fa-check"></i><b>2.2.3</b> R6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-extensions.html"><a href="r-extensions.html"><i class="fa fa-check"></i><b>3</b> R extensions</a><ul>
<li class="chapter" data-level="3.1" data-path="r-extensions.html"><a href="r-extensions.html#c-and-rcpp"><i class="fa fa-check"></i><b>3.1</b> C++ and Rcpp</a><ul>
<li class="chapter" data-level="3.1.1" data-path="r-extensions.html"><a href="r-extensions.html#rcpp-in-a-package"><i class="fa fa-check"></i><b>3.1.1</b> Rcpp in a package</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-extensions.html"><a href="r-extensions.html#writing-c"><i class="fa fa-check"></i><b>3.1.2</b> Writing <code>C++</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-extensions.html"><a href="r-extensions.html#fortran"><i class="fa fa-check"></i><b>3.2</b> Fortran</a></li>
<li class="chapter" data-level="3.3" data-path="r-extensions.html"><a href="r-extensions.html#reticulate"><i class="fa fa-check"></i><b>3.3</b> Reticulate</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-data.html"><a href="working-with-data.html"><i class="fa fa-check"></i><b>4</b> Working with data</a><ul>
<li class="chapter" data-level="4.1" data-path="working-with-data.html"><a href="working-with-data.html#tidyverse"><i class="fa fa-check"></i><b>4.1</b> tidyverse</a></li>
<li class="chapter" data-level="4.2" data-path="working-with-data.html"><a href="working-with-data.html#data.table"><i class="fa fa-check"></i><b>4.2</b> data.table</a></li>
<li class="chapter" data-level="4.3" data-path="working-with-data.html"><a href="working-with-data.html#data-structures"><i class="fa fa-check"></i><b>4.3</b> Data structures</a></li>
<li class="chapter" data-level="4.4" data-path="working-with-data.html"><a href="working-with-data.html#databases"><i class="fa fa-check"></i><b>4.4</b> Databases</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html"><i class="fa fa-check"></i><b>5</b> Data analysis and statistical modeling</a><ul>
<li class="chapter" data-level="5.1" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#stan"><i class="fa fa-check"></i><b>5.1</b> Stan</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#rstanarm"><i class="fa fa-check"></i><b>5.1.1</b> Rstanarm</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#brms"><i class="fa fa-check"></i><b>5.1.2</b> brms</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#bayesplot"><i class="fa fa-check"></i><b>5.1.3</b> bayesplot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#greta"><i class="fa fa-check"></i><b>5.2</b> greta</a></li>
<li class="chapter" data-level="5.3" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#mcmc"><i class="fa fa-check"></i><b>5.3</b> MCMC</a></li>
<li class="chapter" data-level="5.4" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#mlr-and-openml"><i class="fa fa-check"></i><b>5.4</b> mlR and openML</a></li>
<li class="chapter" data-level="5.5" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#tensorflow"><i class="fa fa-check"></i><b>5.5</b> Tensorflow</a></li>
<li class="chapter" data-level="5.6" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#keras"><i class="fa fa-check"></i><b>5.6</b> Keras</a></li>
<li class="chapter" data-level="5.7" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#statistical-learning"><i class="fa fa-check"></i><b>5.7</b> Statistical learning</a></li>
<li class="chapter" data-level="5.8" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#big-data-analytics"><i class="fa fa-check"></i><b>5.8</b> Big data analytics</a></li>
<li class="chapter" data-level="5.9" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#others"><i class="fa fa-check"></i><b>5.9</b> Others</a><ul>
<li class="chapter" data-level="5.9.1" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#modelr"><i class="fa fa-check"></i><b>5.9.1</b> modelr</a></li>
<li class="chapter" data-level="5.9.2" data-path="data-analysis-and-statistical-modeling.html"><a href="data-analysis-and-statistical-modeling.html#kernlab"><i class="fa fa-check"></i><b>5.9.2</b> kernlab</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>6</b> Optimization</a><ul>
<li class="chapter" data-level="6.1" data-path="optimization.html"><a href="optimization.html#convex-optimization"><i class="fa fa-check"></i><b>6.1</b> Convex optimization</a></li>
<li class="chapter" data-level="6.2" data-path="optimization.html"><a href="optimization.html#non-linear-optimizaton"><i class="fa fa-check"></i><b>6.2</b> Non-linear optimizaton</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html"><i class="fa fa-check"></i><b>7</b> Plotting, reporting and visualizing</a><ul>
<li class="chapter" data-level="7.1" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#layout"><i class="fa fa-check"></i><b>7.1</b> Layout</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#publication-ready-plots"><i class="fa fa-check"></i><b>7.2</b> Publication ready plots</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#colors"><i class="fa fa-check"></i><b>7.3</b> Colors</a></li>
<li class="chapter" data-level="7.4" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#interactive-and-animated-plots"><i class="fa fa-check"></i><b>7.4</b> Interactive and animated plots</a></li>
<li class="chapter" data-level="7.5" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#graphs"><i class="fa fa-check"></i><b>7.5</b> Graphs</a></li>
<li class="chapter" data-level="7.6" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#rmarkdown"><i class="fa fa-check"></i><b>7.6</b> RMarkdown</a></li>
<li class="chapter" data-level="7.7" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#shiny"><i class="fa fa-check"></i><b>7.7</b> Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="plotting-reporting-and-visualizing.html"><a href="plotting-reporting-and-visualizing.html#others-1"><i class="fa fa-check"></i><b>7.8</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>8</b> Miscellaneous</a><ul>
<li class="chapter" data-level="8.1" data-path="miscellaneous.html"><a href="miscellaneous.html#workflow-management"><i class="fa fa-check"></i><b>8.1</b> Workflow management</a></li>
<li class="chapter" data-level="8.2" data-path="miscellaneous.html"><a href="miscellaneous.html#pry-back-the-covers-of-r"><i class="fa fa-check"></i><b>8.2</b> Pry back the covers of R</a></li>
<li class="chapter" data-level="8.3" data-path="miscellaneous.html"><a href="miscellaneous.html#tidy-evaluation"><i class="fa fa-check"></i><b>8.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="8.4" data-path="miscellaneous.html"><a href="miscellaneous.html#compile"><i class="fa fa-check"></i><b>8.4</b> Compile</a></li>
<li class="chapter" data-level="8.5" data-path="miscellaneous.html"><a href="miscellaneous.html#others-2"><i class="fa fa-check"></i><b>8.5</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>9</b> Good practices</a><ul>
<li class="chapter" data-level="9.1" data-path="good-practices.html"><a href="good-practices.html#continuous-integration"><i class="fa fa-check"></i><b>9.1</b> Continuous integration</a></li>
<li class="chapter" data-level="9.2" data-path="good-practices.html"><a href="good-practices.html#version-control"><i class="fa fa-check"></i><b>9.2</b> Version control</a></li>
<li class="chapter" data-level="9.3" data-path="good-practices.html"><a href="good-practices.html#docker"><i class="fa fa-check"></i><b>9.3</b> Docker</a></li>
<li class="chapter" data-level="9.4" data-path="good-practices.html"><a href="good-practices.html#code-style"><i class="fa fa-check"></i><b>9.4</b> Code style</a></li>
<li class="chapter" data-level="9.5" data-path="good-practices.html"><a href="good-practices.html#debugging-c-from-r"><i class="fa fa-check"></i><b>9.5</b> Debugging C++ from R</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essential R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-data" class="section level1">
<h1><span class="header-section-number">4</span> Working with data</h1>
<p>Every analysis of data starts with preprocessing and parsing. The following chapter covers some packages that simplify working with data.</p>
<div id="tidyverse" class="section level2">
<h2><span class="header-section-number">4.1</span> tidyverse</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">data</span>(iris)
<span class="kw">head</span>(iris)</code></pre></div>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">group_by</span>(iris, Species) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">Petal.Length =</span> <span class="kw">mean</span>(Petal.Length), 
    <span class="dt">Sepal.Length =</span> <span class="kw">mean</span>(Sepal.Length)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Species =</span> <span class="kw">toupper</span>(Species)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">head</span>()</code></pre></div>
<pre><code># A tibble: 3 x 3
  Species    Petal.Length Sepal.Length
  &lt;chr&gt;             &lt;dbl&gt;        &lt;dbl&gt;
1 SETOSA             1.46         5.01
2 VERSICOLOR         4.26         5.94
3 VIRGINICA          5.55         6.59</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tidyr<span class="op">::</span><span class="kw">gather</span>(iris, Col, Val, <span class="op">-</span>Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<pre><code>  Species          Col Val
1  setosa Sepal.Length 5.1
2  setosa Sepal.Length 4.9
3  setosa Sepal.Length 4.7
4  setosa Sepal.Length 4.6
5  setosa Sepal.Length 5.0
6  setosa Sepal.Length 5.4</code></pre>
<p>TODO some examples</p>
</div>
<div id="data.table" class="section level2">
<h2><span class="header-section-number">4.2</span> data.table</h2>
<p><code>data.table</code> is a fast implementation of R’s classical <code>data.frame</code>. I hardly ever use data frame any more, and if so only, because it seems to work nicer with <code>dplyr</code> and <code>tidyr</code>. However, by using <code>dtplyr</code> this isn’t much of a problem, really.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(dtplyr)
<span class="kw">library</span>(grid)
<span class="kw">library</span>(gridExtra)

n &lt;-<span class="st"> </span><span class="dv">1000</span>
rn &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">rnorm</span>(n)
ltrs &lt;-<span class="st"> </span>base<span class="op">::</span><span class="kw">sample</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
dt &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">data.table</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)
df &lt;-<span class="st"> </span>base<span class="op">::</span><span class="kw">data.frame</span>(<span class="dt">X =</span> rn, <span class="dt">Y =</span> ltrs)

dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tableGrob</span>(<span class="dt">rows =</span> <span class="ot">NULL</span>) <span class="op">%&gt;%</span><span class="st"> </span>grid.arrange</code></pre></div>
<p><img src="essential-R_files/figure-html/unnamed-chunk-33-1.png" width="192" style="display: block; margin: auto;" /></p>
<p>In the end it depends what style you prefer. I usually go with <code>data.table</code> alone without needing the <code>dplyr/dtplyr</code> dependency. However, the latter is usually more readable. For large data, the fastest solution is probably preferable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt.only &lt;-<span class="st"> </span><span class="cf">function</span>() dt[, .SD[<span class="kw">sample</span>(.N, <span class="dv">1</span>)], by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>)]
dt.dtplyr &lt;-<span class="st"> </span><span class="cf">function</span>() dt <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Y) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(<span class="dv">1</span>)
df.dplyr &lt;-<span class="st"> </span><span class="cf">function</span>() df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Y) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(<span class="dv">1</span>)

microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">dt.only</span>(), <span class="kw">dt.dtplyr</span>(), <span class="kw">df.dplyr</span>())</code></pre></div>
<pre><code>Unit: microseconds
        expr      min        lq      mean   median       uq         max
   dt.only() 1414.785 1586.2480  5779.886 1703.112 2298.637   68805.670
 dt.dtplyr() 2124.899 2327.8425 41565.427 2641.847 8450.181 3576499.515
  df.dplyr()  724.789  841.0025  1082.067  941.272 1057.872    7787.377
 neval
   100
   100
   100</code></pre>
</div>
<div id="data-structures" class="section level2">
<h2><span class="header-section-number">4.3</span> Data structures</h2>
<p>If you have a background in computer science you may wonder, that R does not have support for advanced data structures such as Fibonacci heaps or hashmaps. <code>datastructures</code> tries to solve this. It uses Rcpp modules to export Boost data structures to R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(datastructures)
q &lt;-<span class="st"> </span>datastructures<span class="op">::</span><span class="kw">fibonacci_heap</span>(<span class="st">&quot;integer&quot;</span>)
q[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rnorm</span>(<span class="dv">3</span>), <span class="dv">2</span>, <span class="kw">rnorm</span>(<span class="dv">4</span>))
datastructures<span class="op">::</span><span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`1`
[1] -0.1297980 -0.7222048  0.8822356</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures<span class="op">::</span><span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`2`
[1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures<span class="op">::</span><span class="kw">pop</span>(q)</code></pre></div>
<pre><code>$`3`
[1] -0.9690185  0.5841185 -0.4897903  0.4729006</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastructures<span class="op">::</span><span class="kw">pop</span>(q)</code></pre></div>
<pre><code>NULL</code></pre>
<p>TODO examples</p>
</div>
<div id="databases" class="section level2">
<h2><span class="header-section-number">4.4</span> Databases</h2>
<p>TODO neo4j, maria, sqltie, mongodb, dbplyr</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-extensions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-analysis-and-statistical-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
